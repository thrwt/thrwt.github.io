<!DOCTYPE html>
<html>
<head>
    <title>BelkaCTF #7: Stranger Dfings - thrwt</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="../js/main.js"></script>
</head>
<body>
<div class="navbar">
    <div class="logo"><a href="../index.html">THRWT</a></div>
    <div>
        <a href="../index.html">Home</a>
        <a href="../Notes.html">Notes</a>
        <a href="../about.html">About</a>
    </div>
</div>

<div class="container">
    <!-- LEFT SIDEBAR -->
    <div class="sidebar">
        <img src="../images/Image .jpg" alt="Profile">
        <h2>Mohamed Tharwat</h2>
        <p>OMG</p>
        <div class="icons">
            <a href="https://www.linkedin.com/in/mohamed-tharwat1/"><ion-icon name="logo-linkedin"></ion-icon></a>
            <a href="https://medium.com/@mohamedtharwat_67874"><ion-icon name="logo-medium"></ion-icon></a>
            <a href="https://discord.com/users/1210726491088887838"><ion-icon name="logo-discord"></ion-icon></a>
        </div>
    </div>

    <!-- MAIN CONTENT - بدون Categories على اليمين -->
    <div class="content">
        <!-- معلومات الـ Writeup -->
        <div class="post">
            <h1>BelkaCTF #7: Stranger Dfings</h1>
            
            <!-- Meta Info -->
            <div class="post-meta" style="margin-bottom: 20px;">
                <div class="post-meta-item">
                    <ion-icon name="calendar-outline"></ion-icon>
                    <span>Dec 18, 2025</span>
                </div>
                <div class="post-meta-item">
                    <ion-icon name="time-outline"></ion-icon>
                    <span class="reading-time">Calculating...</span>
                </div>
                <div class="post-meta-item">
                    <ion-icon name="pricetag-outline"></ion-icon>
                    <span>Belkasoft CTF</span>
                </div>
                <div class="post-meta-item">
                </div>
            </div>

            <!-- صورة رئيسية -->
            <img src="/images/Stranger_Dfings/thumbnail.jpg" class="writeup-image" alt="Writeup Image">

            <!-- المحتوى -->
            <h2>Overview</h2>
            <p> 
 <strong> Hi Geeks, 
Here is my writeup for Stranger Dfings, The forensics challenges in this walkthrough are awesome, and I learned a lot from them.
I know the official writeup has already been published, but there are some steps that were skipped or not clearly explained.
So, I decided to share my own writeup for it. </strong>
  <p>I hope you enjoy it. </p>
            </p>

                     <h2>What is the username and hostname of the imaged machine?</h2>
            
                <p> In this case I will Use MemProcFS , it will make the investigation is easier </p>
            
                 run in cmd
                <pre style="background: #1a1a1a; padding: 15px; border-radius: 8px; overflow-x: auto; color: #00ff00;">
                    MemProcFS.exe -device path to /BelkaCTF_7_CASE250722_KTSOAERO.mem -forensic 1  </pre>
            
        <p> Will appear a new partition in Ur PC </p>
            <img src="/images/Stranger_Dfings/1.png" alt="M partition" width="800">
                </p>

                 <p> For the username, just check the users </p>
            
            <span class="path">M:\forensic\files\ROOT\Users</span>
            
                <p>For hostname, you can find it in Registry </p>
            
            <span class="path">M:\registry\HKLM\SYSTEM\ControlSet001\Control\ComputerName\ComputerName </span>
        
              <img src="/images/Stranger_Dfings/2.png" alt="M partition" width="800">
                                 
              <p> OR in 
                Environment Variables,You can check any process under user mode processes then navigate to win-environment.txt
                and grep to ComputerName  </p>






            
                        <h2>There is something rogue running on this machine. What is the malware executable file name?</h2>
            <p>
                If you check the process from pslist or findevil you will see the *epxlorer* It’s so clear 
                <img src="/images/Stranger_Dfings/4.png" alt="M partition" width="800">

            </p>


                       <h2>What is the MD5 hash of the malware running on the machine?</h2>
            
            <p> You will find the process in Downloads </p>
            
                            <span class="path">M:\forensic\files\ROOT\Users\award\Downloads</span>
                <img src="/images/Stranger_Dfings/5.png" alt="M partition" width="800">
                <P> Then calc the md5</P>
            <img src="/images/Stranger_Dfings/6.png" alt="M partition" width="800">
        
            </p>





            
                     <h2>What was the email address of the person spreading the malware?</h2>
             
            <p> let’s check the inbox </p>
            
                <span class="path">M:\forensic\files\ROOT\Users\award\AppData\Local\Microsoft\Windows Live Mail\Posteo (ale 254\Inbox </span>

                  <p> already you will get the mail spreading the malware</p>
            <img src="/images/Stranger_Dfings/7.png" alt="M partition" width="800">
            <p> Then get the email sender </p>
            <img src="/images/Stranger_Dfings/8.png" alt="M partition" width="800">




            

                       <h2>What is the intruder-hosted Telegram API server used by the malware?</h2>
            
            <p> Let’s go with Some reversing 
        First you need to identify about this process , you can use Detect It Easy</p>

            <img src="/images/Stranger_Dfings/9.png" alt="M partition" width="800">
            <p> This process written by C# , .NET frame work
         You can use Tools like dnSpy  (debugger and assembly editor built for .NET files C# ) </p>
            <img src="/images/Stranger_Dfings/10.png" alt="M partition" width="800">
            <P> You will notice the origin process is locker.exe then open the form1, and you will get the hosted Telegram API server </P>


            

                    <h2>What is the Telegram Bot API key hard-coded into the malware executable?</h2>
         <p>
            in the same form1 , I found the Telegram  API key and** see the array of numbers apply on it XOR string deobfuscation
            with XOR key  <strong> (&^%4&^%$*&6 </strong>
           </p>
            <img src="/images/Stranger_Dfings/11.png" alt="M partition" width="800">
            <p>
                you can generate script to decrypt it in any AI model and you will get the Telegram Bot API key
               <strong>8169267144:AAFwkhmXh71SMVcvFLantjTlwlRbT9HdJdU</strong>
                
            </p>

                              <h2>What is the phone number of the malware operator?</h2>
            <p>This Q Just need to order Ur mind </p>
 
            We have a
            
  <p>- hosted Telegram API server <strong>https://api-telegram-org.ctf.do/</strong>  </p>
  <p> -Telegram Bot API key <strong> 8169267144:AAFwkhmXh71SMVcvFLantjTlwlRbT9HdJdU </strong>  </p>
  <p> - admin Telegram ID  <strong> 7474460026 </strong>strong> </p>
      <p> let’s search in google, “how to get information about telegram bot using Telegram Bot API key and admin Telegram ID” </p>
      
     <p> you will find a lot like that , take a look to more understand </p> 

<ul>
    <li>
        <a href="https://socprime.com/active-threats/detection-response-chronicles-exploring-telegram-abuse/" target="_blank">
            Detection Response Chronicles – Exploring Telegram Abuse
        </a>
    </li>
    <li>
        <a href="https://gist.github.com/nafiesl/4ad622f344cd1dc3bb1ecbe468ff9f8a" target="_blank">
            nafiesl – Telegram Bot Example
        </a>
    </li>
    <li>
        <a href="https://core.telegram.org/bots/api#getting-updates" target="_blank">
            Telegram Bot API – Getting Updates
        </a>
    </li>
</ul>   
      <P> But , just focus in official telegram blog </P>

                  <img src="/images/Stranger_Dfings/12.png" alt="M partition" width="800">
      <p> let’s construct URl, but i need method to return a data about Malware Operator </p>
      <p> let’s find this method </p> 
      <p> open the blog then go to the Available Methods , you will get the method Name getChat , that’s return username </p>

                  <img src="/images/Stranger_Dfings/13.png" alt="M partition" width="800">
         <p> Use curl to make requests and get the data </p>
      <code style="background:#1e1e1e; color:#ff5555; padding:4px 8px; border-radius:6px;">
curl https://api-telegram-org.ctf.do/bot8169267144:AAFwkhmXh71SMVcvFLantjTlwlRbT9HdJdU/getChat?chat_id=7474460026  </code>
         
                  <img src="/images/Stranger_Dfings/14.png" alt="M partition" width="800">
      <p> OMG, already have a Username, just open the telegram and search for user ,you will get the number</p>



                   <h2>What is the Google account this phone is set up with?</h2>
            <p> Just go on in this Path , you will find it </p>
            <span class="path">\data\data\com.google.android.gm\databases\user_accounts</span>
            
                        <img src="/images/Stranger_Dfings/15.0.png" alt="M partition" width="800">
            <p> Or Using ALEAPP Open source forensic analysis tool for Android mobile devices, That’s will Help us in mission</p>
                                    <img src="/images/Stranger_Dfings/15.png" alt="M partition" width="800">






                                       <h2> Where does the phone owner work and what’s his position?</h2>

          <p> I think most of this Questions Solved by check usual places. like Gmail, WhatsApp and Browser artifacts  </p>

<P> -lets check gmail </p>

                        <span class="path">\data\data\[com.google.android.gm](http://com.google.android.gm/)\databases\EmailProvider.db</span>
            <p>open it in DB Browser (SQLite)</p>
                                      <img src="/images/Stranger_Dfings/16.png" alt="M partition" width="800">
            <p>OR</p>
                         
            <span class="path">\data\data\com.google.android.gm\files\body\0\9</span>
            <img src="/images/Stranger_Dfings/17.png" alt="M partition" width="800">


            

            <h2>What are the last 4 digits of the suspect’s bank card, and the contact phone number of his bank?</h2>
            
            <p>After Some digging , I found this receipt in mail files</p>
            <p> 
            <span class="path">\data\data\com.google.android.gm\files\downloads\f41908c5a393c34716efca9d14a6bb31\attachments\b1b4700f-188f-4932-a919-5f9a1228a4ad.pdf</span> </p>
            <img src="/images/Stranger_Dfings/18.png" alt="M partition" width="600">

            <p>We got the last 4 digits , let’s find contact phone of this bank,I’ve checked the Contact, WhatsApp, mail and Spotify App, but didn’t find anything</p>

            <p>When checked chrome browser history</p> 
<span class="path">\data\data\com.android.chrome\app_chrome\Default\History</span>
            <img src="/images/Stranger_Dfings/19.png" alt="M partition" width="800">
            <p>We found the URL of this bank , just open the URL and go to contact info </p>
            <img src="/images/Stranger_Dfings/20.png" alt="M partition" width="800">
            




            
            <h2>Which dependency-causing substance is mentioned in the chat logs on the phone?</h2>
            
            <p>let’s go to the WhatsApp chat logs and you got the, substance It’s Caffeine , leave the Writeup and go to drink this drug</p>
            <img src="/images/Stranger_Dfings/21.png" alt="M partition" width="800">







            
            <h2>Where the two missing people—an activist and a teenager—can be retrieved?</h2>
            
            <p>After Some search , didn’t found anything, but when read the story , I noticed that</p>
            <img src="/images/Stranger_Dfings/22.png" alt="M partition" width="800">
            
            <p>So , lets check chat’s again </p>

<P>already found the chats, a lot of coordinates, and try a lot to understand the scenario but didn’t found any trace about of two missing people
    <P>I have a skill issues or Something is wrong</p>

            

            
            <h2>What is the password of the suspect’s home Wi-Fi network?</h2>
    
            <P> Reminder geeks, Still in android challenge, you will find the password of this Network In </P>
            <span class="path">\data\misc\apexdata\com.android.wifi\WifiConfigStore.xml</span>
            <img src="/images/Stranger_Dfings/23.png" alt="M partition" width="800">

            <P>OR Open ALEAPP and check the Wi-Fi Profile</P>
             <img src="/images/Stranger_Dfings/24.png" alt="M partition" width="800">
            

            


            
            <h2>What does the suspect call himself since recently? Decrypt the traffic.</h2>
                <p>to decrypt the traffic you need the password or key of this traffic</p>
                 <p> we got it in previous Q `G0P1n3APL!` </p>
                 <p>demo to Decrypt the traffic</p>

              <a href=https://www.wireshark.org/docs/wsug_html_chunked/Ch80211Keys.html" target="_blank">
            WLAN Decryption Keys
        </a>
            <p>After that you need the Expert the file in WireShark </p>
             <img src="/images/Stranger_Dfings/25.png" alt="M partition" width="800">
            <p>Then , you will find some pictures and found the suspect call himself</p>
             <img src="/images/Stranger_Dfings/26.png" alt="M partition" width="800">
            
            





            
            <h2>Figure out the moment when the suspect’s body started acting weird as precisely as you can?</h2>
            
            <p>let’s check any health app in our image, get xiaomi.hm.health in  </p>

             <span class="path"> \data\data\com.xiaomi.hm.health\databases</span>
<p>and there are a lot of databases, but find the <storng>origin_db_ef2042f8ec65801481fb688859d4e279</storng></p>
<p>we found the table named Heart_rate let’s check it </p>
            <p>let’s know what is the normal range</p>
            
                <img src="/images/Stranger_Dfings/27.png" alt="M partition" width="800">
            <p>we found the very low heart rate , this is indictor of Start acting weird </p>
                            <img src="/images/Stranger_Dfings/28.png" alt="M partition" width="800">
            <p>The time in Unix epoch format Convert it using [epochconverter]</p>
                                <img src="/images/Stranger_Dfings/28.1.png" alt="M partition" width="800">
        



            <h2>What is the car the jour… alien drives?</h2>
<p>After Some digging in the usual places in image , didn’t find anything </p> 
<p> let’s check the folders and try to find any traces </p>
<P> -when open database of this folder</P>
            <span class="path">\data\data\com.google.android.projection.gearhead</span>
<p>OMG, let’s check that </p>
               <img src="/images/Stranger_Dfings/29.png" alt="M partition" width="800">
            <p>broo, we got it</p>
                                            <img src="/images/Stranger_Dfings/30.png" alt="M partition" width="800">


            




            
            <h2>Mine the ATC software logs for serial numbers of the radars that spotted a UFO flying by.?</h2>

 <p>let’s go back in memory dump and using MemProcFS</p>
 <p>and going to the ATC software (Air Traffic Control) </p>
 <p>then program data of this application to see the logs </p>

            <span class="path">M:\forensic\files\ROOT\Users\award\AppData\Local\Programs\ATC_RADAR\resources\app\radar_data.db</span>
<p>already found the UFO (Unidentified Flying Object) with call sign UFO137</p>
               <img src="/images/Stranger_Dfings/31.png" alt="M partition" width="800">
            <p>you will get the serial in the radar serial table , but i faced the problem when submit the serial</p>
            <img src="/images/Stranger_Dfings/32.png" alt="M partition" width="800">
            
        <p>  Back to the official writeup the, just submit all expect the last one, When check the files find this radar station in `renderer.js` </p>  
<p> That’s  like a group of radar stations with different Geo  </p>  
            <img src="/images/Stranger_Dfings/33.png" alt="M partition" width="800">
            <p><strong>I think the last one didn’t send the sign to the UFO137 call sign , but tbh didn’t find any trace to prove that , good lock geeks.</strong></p>

            
          
            

            


      


            <!-- Back Button -->
            <div style="margin-top: 40px;">
                <a href="../index.html" style="display: inline-block; padding: 12px 24px; background: #8ab4f8; color: #0e141b; text-decoration: none; border-radius: 8px; font-weight: 600;">
                    ← Back to Home
                </a>
            </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/ionicons@5.5.2/dist/ionicons.js"></script>
</body>
</html>
