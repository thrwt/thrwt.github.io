<!DOCTYPE html>
<html>
<head>
    <title>BelkaCTF #7: Stranger Dfings - thrwt</title>
    <link rel="stylesheet" href="../css/style.css">
    <script src="../js/reading-time.js"></script>
</head>
<body>
<div class="navbar">
    <div class="logo"><a href="../index.html">THRWT</a></div>
    <div>
        <a href="../index.html">Home</a>
        <a href="../Notes.html">Notes</a>
        <a href="../about.html">About</a>
    </div>
</div>

<div class="container">
    <!-- LEFT SIDEBAR -->
    <div class="sidebar">
        <img src="../images/Image .jpg" alt="Profile">
        <h2>Mohamed Tharwat</h2>
        <p>OMG</p>
        <div class="icons">
            <a href="https://www.linkedin.com/in/mohamed-tharwat1/"><ion-icon name="logo-linkedin"></ion-icon></a>
            <a href="https://medium.com/@mohamedtharwat_67874"><ion-icon name="logo-medium"></ion-icon></a>
            <a href="https://discord.com/users/1210726491088887838"><ion-icon name="logo-discord"></ion-icon></a>
        </div>
    </div>

    <!-- MAIN CONTENT - بدون Categories على اليمين -->
    <div class="content">
        <!-- معلومات الـ Writeup -->
        <div class="post">
            <h1>BelkaCTF #7: Stranger Dfings</h1>
            
            <!-- Meta Info -->
            <div class="post-meta" style="margin-bottom: 20px;">
                <div class="post-meta-item">
                    <ion-icon name="calendar-outline"></ion-icon>
                    <span>Dec 18, 2025</span>
                </div>
                <div class="post-meta-item">
                    <ion-icon name="time-outline"></ion-icon>
                    <span class="reading-time">Calculating...</span>
                </div>
                <div class="post-meta-item">
                    <ion-icon name="pricetag-outline"></ion-icon>
                    <span>Belkasoft CTF</span>
                </div>
                <div class="post-meta-item">
                </div>
            </div>

            <!-- صورة رئيسية -->
            <img src="/images/Stranger_Dfings/thumbnail.jpg" class="writeup-image" alt="Writeup Image">

            <!-- المحتوى -->
            <h2>Overview</h2>
            <p> 
 <strong> Hi Geeks, 
Here is my writeup for Stranger Dfings, The forensics challenges in this walkthrough are awesome, and I learned a lot from them.
I know the official writeup has already been published, but there are some steps that were skipped or not clearly explained.
So, I decided to share my own writeup for it. </strong>
  <p>I hope you enjoy it. </p>
            </p>

                     <h2>What is the username and hostname of the imaged machine?</h2>
            
                <p> In this case I will Use MemProcFS , it will make the investigation is easier </p>
            
                 run in cmd
                <pre style="background: #1a1a1a; padding: 15px; border-radius: 8px; overflow-x: auto; color: #00ff00;">
                    MemProcFS.exe -device path to /BelkaCTF_7_CASE250722_KTSOAERO.mem -forensic 1  </pre>
            
        <p> Will appear a new partition in Ur PC </p>
            <img src="/images/Stranger_Dfings/1.png" alt="M partition" width="800">
                </p>

                 <p> For the username, just check the users </p>
            
            <span class="path">M:\forensic\files\ROOT\Users</span>
            
                <p>For hostname, you can find it in Registry </p>
            
            <span class="path">M:\registry\HKLM\SYSTEM\ControlSet001\Control\ComputerName\ComputerName </span>
        
              <img src="/images/Stranger_Dfings/2.png" alt="M partition" width="800">
                                 
              <p> OR in 
                Environment Variables,You can check any process under user mode processes then navigate to win-environment.txt
                and grep to ComputerName  </p>






            
                        <h2>There is something rogue running on this machine. What is the malware executable file name?</h2>
            <p>
                If you check the process from pslist or findevil you will see the *epxlorer* It’s so clear 
                <img src="/images/Stranger_Dfings/4.png" alt="M partition" width="800">

            </p>


                       <h2>What is the MD5 hash of the malware running on the machine?</h2>
            
            <p> You will find the process in Downloads </p>
            
                            <span class="path">M:\forensic\files\ROOT\Users\award\Downloads</span>
                <img src="/images/Stranger_Dfings/5.png" alt="M partition" width="800">
                <P> Then calc the md5</P>
            <img src="/images/Stranger_Dfings/6.png" alt="M partition" width="800">
        
            </p>





            
                     <h2>What was the email address of the person spreading the malware?</h2>
             
            <p> let’s check the inbox </p>
            
                <span class="path">M:\forensic\files\ROOT\Users\award\AppData\Local\Microsoft\Windows Live Mail\Posteo (ale 254\Inbox </span>

                  <p> already you will get the mail spreading the malware</p>
            <img src="/images/Stranger_Dfings/7.png" alt="M partition" width="800">
            <p> Then get the email sender </p>
            <img src="/images/Stranger_Dfings/8.png" alt="M partition" width="800">




            

                       <h2>What is the intruder-hosted Telegram API server used by the malware?</h2>
            
            <p> Let’s go with Some reversing 
        First you need to identify about this process , you can use Detect It Easy</p>

            <img src="/images/Stranger_Dfings/9.png" alt="M partition" width="800">
            <p> This process written by C# , .NET frame work
         You can use Tools like dnSpy  (debugger and assembly editor built for .NET files C# ) </p>
            <img src="/images/Stranger_Dfings/10.png" alt="M partition" width="800">
            <P> You will notice the origin process is locker.exe then open the form1, and you will get the hosted Telegram API server </P>


            

                    <h2>What is the Telegram Bot API key hard-coded into the malware executable?</h2>
         <p>
            in the same form1 , I found the Telegram  API key and** see the array of numbers apply on it XOR string deobfuscation
            with XOR key  <strong> (&^%4&^%$*&6 </strong>
           </p>
            <img src="/images/Stranger_Dfings/11.png" alt="M partition" width="800">
            <p>
                you can generate script to decrypt it in any AI model and you will get the Telegram Bot API key
               <strong>8169267144:AAFwkhmXh71SMVcvFLantjTlwlRbT9HdJdU</strong>
                
            </p>

                              <h2>What is the phone number of the malware operator?</h2>
            <p>This Q Just need to order Ur mind </p>
 
            We have a
            
  <p>- hosted Telegram API server <strong>https://api-telegram-org.ctf.do/</strong>  </p>
  <p> -Telegram Bot API key <strong> 8169267144:AAFwkhmXh71SMVcvFLantjTlwlRbT9HdJdU </strong>  </p>
  <p> - admin Telegram ID  <strong> 7474460026 <strong>  </p>
      <p> let’s search in google  <strong>“how to get information about telegram bot using Telegram Bot API key and admin Telegram ID</strong> ”</p>
      
     <p> you will find a lot like that , take a look to more understand </p> 

      <a href="https://socprime.com/active-threats/detection-response-chronicles-exploring-telegram-abuse/">detection-response-chronicles-exploring-telegram-abuse</a> 
      <a herf="https://gist.github.com/nafiesl/4ad622f344cd1dc3bb1ecbe468ff9f8a" >nafiesl</a>
      <a herf="https://core.telegram.org/bots/api#getting-updates" >api#getting-updates</a>
      
      <P> But , just focus in official telegram blog </P>

                  <img src="/images/Stranger_Dfings/12.png" alt="M partition" width="800">
      <p> let’s construct URl, but i need method to return a data about Malware Operator </p>
      <p> let’s find this method </p> 
      <p> open the blog then go to the Available Methods , you will get the method Name getChat , that’s return username </p>

                  <img src="/images/Stranger_Dfings/13.png" alt="M partition" width="800">
         <p> Use curl to make requests and get the data </p>
      <code style="background:#1e1e1e; color:#ff5555; padding:4px 8px; border-radius:6px;">
curl https://api-telegram-org.ctf.do/bot8169267144:AAFwkhmXh71SMVcvFLantjTlwlRbT9HdJdU/getChat?chat_id=7474460026  </code>
         
                  <img src="/images/Stranger_Dfings/14.png" alt="M partition" width="800">
      <p> OMG, already have a Username, just open the telegram and search for user ,you will get the number</p>

      


            <!-- Back Button -->
            <div style="margin-top: 40px;">
                <a href="../index.html" style="display: inline-block; padding: 12px 24px; background: #8ab4f8; color: #0e141b; text-decoration: none; border-radius: 8px; font-weight: 600;">
                    ← Back to Home
                </a>
            </div>
        </div>
    </div>
</div>

<script src="https://unpkg.com/ionicons@5.5.2/dist/ionicons.js"></script>
</body>
</html>
